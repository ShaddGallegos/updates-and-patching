<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vulnerability Report - {{ vulner_report_data.scan_info.hostname }}</title>
<style>
body {
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
line-height: 1.6;
margin: 0;
padding: 20px;
background-color: #f5f5f5;
}
.container {
max-width: 1200px;
margin: 0 auto;
background: white;
padding: 30px;
border-radius: 10px;
box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}
.header {
text-align: center;
border-bottom: 3px solid #e74c3c;
padding-bottom: 20px;
margin-bottom: 30px;
}
.risk-banner {
padding: 15px;
margin: 20px 0;
border-radius: 5px;
text-align: center;
font-weight: bold;
font-size: 1.2em;
}
.risk-critical { background: #e74c3c; color: white; }
.risk-high { background: #f39c12; color: white; }
.risk-medium { background: #f1c40f; color: #333; }
.risk-low { background: #27ae60; color: white; }
.risk-secure { background: #2ecc71; color: white; }
.metrics {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 20px;
margin: 30px 0;
}
.metric-card {
background: #f8f9fa;
padding: 20px;
border-radius: 8px;
text-align: center;
border-left: 4px solid #3498db;
}
.metric-number {
font-size: 2em;
font-weight: bold;
color: #2c3e50;
}
.metric-label {
color: #7f8c8d;
margin-top: 5px;
}
.vulnerability-section {
margin: 30px 0;
}
.vuln-table {
width: 100%;
border-collapse: collapse;
margin: 20px 0;
}
.vuln-table th, .vuln-table td {
border: 1px solid #ddd;
padding: 12px;
text-align: left;
}
.vuln-table th {
background-color: #34495e;
color: white;
}
.vuln-table tr:nth-child(even) {
background-color: #f2f2f2;
}
.severity-critical { background-color: #ffebee; }
.severity-high { background-color: #fff3e0; }
.severity-medium { background-color: #fffde7; }
.severity-low { background-color: #f1f8e9; }
.system-info {
background: #ecf0f1;
padding: 20px;
border-radius: 8px;
margin: 20px 0;
}
.recommendations {
background: #e8f6f3;
padding: 20px;
border-radius: 8px;
border-left: 4px solid #27ae60;
}
.timestamp {
text-align: right;
color: #7f8c8d;
margin-top: 30px;
font-style: italic;
}
.alert {
padding: 15px;
margin: 15px 0;
border-radius: 5px;
border: 1px solid;
}
.alert-danger {
background-color: #f8d7da;
border-color: #f5c6cb;
color: #721c24;
}
.alert-warning {
background-color: #fff3cd;
border-color: #ffeaa7;
color: #856404;
}
.remediation-status {
background: #d1ecf1;
padding: 15px;
border-radius: 5px;
border-left: 4px solid #17a2b8;
margin: 20px 0;
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1> Vulnerability Security Report</h1>
<h2>{{ vulner_report_data.scan_info.hostname }}</h2>
<p>{{ vulner_report_data.scan_info.ip_address }} | {{ vulner_report_data.scan_info.scan_timestamp }}</p>
</div>

<div class="risk-banner risk-{{ vulner_report_data.vulnerability_summary.risk_level.lower() }}">
RISK LEVEL: {{ vulner_report_data.vulnerability_summary.risk_level }}
</div>

{% if vulner_report_data.vulnerability_summary.critical_count > 0 %}
  <div class="alert alert-danger">
  <strong> CRITICAL ALERT:</strong> {{ vulner_report_data.vulnerability_summary.critical_count }} critical vulnerabilities require immediate attention!
  </div>
{% endif %}

<div class="metrics">
<div class="metric-card">
<div class="metric-number">{{ vulner_report_data.vulnerability_summary.total_vulnerabilities }}</div>
<div class="metric-label">Total Vulnerabilities</div>
</div>
<div class="metric-card">
<div class="metric-number" style="color: #e74c3c;">{{ vulner_report_data.vulnerability_summary.critical_count }}</div>
<div class="metric-label">Critical</div>
</div>
<div class="metric-card">
<div class="metric-number" style="color: #f39c12;">{{ vulner_report_data.vulnerability_summary.high_count }}</div>
<div class="metric-label">High Priority</div>
</div>
<div class="metric-card">
<div class="metric-number" style="color: #f1c40f;">{{ vulner_report_data.vulnerability_summary.medium_count }}</div>
<div class="metric-label">Medium Priority</div>
</div>
<div class="metric-card">
<div class="metric-number" style="color: #27ae60;">{{ vulner_report_data.vulnerability_summary.low_count }}</div>
<div class="metric-label">Low Priority</div>
</div>
</div>

<div class="system-info">
<h3> System Information</h3>
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
<div>
<strong>Operating System:</strong> {{ vulner_report_data.system_info.distribution }} {{ vulner_report_data.system_info.distribution_version }}<br>
<strong>Kernel Version:</strong> {{ vulner_report_data.system_info.kernel_version }}<br>
<strong>Architecture:</strong> {{ vulner_report_data.system_info.architecture }}<br>
<strong>Virtualization:</strong> {{ vulner_report_data.system_info.virtualization_type }}<br>
</div>
<div>
<strong>Memory:</strong> {{ vulner_report_data.system_info.total_memory }}<br>
<strong>CPU Cores:</strong> {{ vulner_report_data.system_info.cpu_cores }}<br>
<strong>Uptime:</strong> {{ vulner_report_data.system_info.uptime }}<br>
<strong>Scan Duration:</strong> {{ vulner_report_data.scan_info.scan_duration }}<br>
</div>
</div>
</div>

{% if vulner_report_data.remediation_info.remediation_completed %}
  <div class="remediation-status">
  <h3> Remediation Status</h3>
  <p><strong>Auto-remediation:</strong> {{ 'Enabled' if vulner_report_data.remediation_info.auto_remediate_enabled else 'Disabled' }}</p>
  <p><strong>Remediation completed:</strong> {{ vulner_report_data.remediation_info.remediation_timestamp }}</p>
  <p><strong>Backup created:</strong> {{ 'Yes' if 'backup' in vulner_report_data.remediation_info.backup_created else 'No' }}</p>
  {% if vulner_report_data.remediation_info.reboot_required %}
    <p><strong> Reboot required:</strong> Yes - System reboot needed to apply kernel updates</p>
  {% endif %}
  </div>
{% endif %}

{% if vulner_report_data.vulnerabilities.all | length > 0 %}
  <div class="vulnerability-section">
  <h3> Vulnerability Details</h3>

  {% if vulner_report_data.vulnerabilities.critical | length > 0 %}
    <h4 style="color: #e74c3c;"> Critical Vulnerabilities</h4>
    <table class="vuln-table">
    <thead>
    <tr>
    <th>Vulnerability ID</th>
    <th>Component</th>
    <th>Description</th>
    <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {% for vuln in vulner_report_data.vulnerabilities.critical %}
      <tr class="severity-critical">
      <td><strong>{{ vuln.split(':')[0] }}</strong></td>
      <td>{{ vuln.split(':')[1] if ':' in vuln else 'System' }}</td>
      <td>{{ vuln.split(':')[2] if vuln.split(':') | length > 2 else 'Critical security vulnerability detected' }}</td>
      <td> Active</td>
      </tr>
    {% endfor %}
    </tbody>
    </table>
  {% endif %}

  {% if vulner_report_data.vulnerabilities.high | length > 0 %}
    <h4 style="color: #f39c12;"> High Priority Vulnerabilities</h4>
    <table class="vuln-table">
    <thead>
    <tr>
    <th>Vulnerability ID</th>
    <th>Component</th>
    <th>Description</th>
    <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {% for vuln in vulner_report_data.vulnerabilities.high %}
      <tr class="severity-high">
      <td><strong>{{ vuln.split(':')[0] }}</strong></td>
      <td>{{ vuln.split(':')[1] if ':' in vuln else 'System' }}</td>
      <td>{{ vuln.split(':')[2] if vuln.split(':') | length > 2 else 'High priority security issue' }}</td>
      <td> Active</td>
      </tr>
    {% endfor %}
    </tbody>
    </table>
  {% endif %}

  {% if vulner_report_data.vulnerabilities.medium | length > 0 %}
    <h4 style="color: #f1c40f;"> Medium Priority Vulnerabilities</h4>
    <table class="vuln-table">
    <thead>
    <tr>
    <th>Vulnerability ID</th>
    <th>Component</th>
    <th>Description</th>
    <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {% for vuln in vulner_report_data.vulnerabilities.medium %}
      <tr class="severity-medium">
      <td><strong>{{ vuln.split(':')[0] }}</strong></td>
      <td>{{ vuln.split(':')[1] if ':' in vuln else 'System' }}</td>
      <td>{{ vuln.split(':')[2] if vuln.split(':') | length > 2 else 'Medium priority security concern' }}</td>
      <td> Active</td>
      </tr>
    {% endfor %}
    </tbody>
    </table>
  {% endif %}

  {% if vulner_report_data.vulnerabilities.low | length > 0 %}
    <h4 style="color: #27ae60;"> Low Priority Vulnerabilities</h4>
    <table class="vuln-table">
    <thead>
    <tr>
    <th>Vulnerability ID</th>
    <th>Component</th>
    <th>Description</th>
    <th>Status</th>
    </tr>
    </thead>
    <tbody>
    {% for vuln in vulner_report_data.vulnerabilities.low %}
      <tr class="severity-low">
      <td><strong>{{ vuln.split(':')[0] }}</strong></td>
      <td>{{ vuln.split(':')[1] if ':' in vuln else 'System' }}</td>
      <td>{{ vuln.split(':')[2] if vuln.split(':') | length > 2 else 'Low priority security item' }}</td>
      <td> Active</td>
      </tr>
    {% endfor %}
    </tbody>
    </table>
  {% endif %}
  </div>
  {% else %}
  <div class="alert" style="background-color: #d4edda; border-color: #c3e6cb; color: #155724;">
  <strong> Excellent!</strong> No vulnerabilities detected on this system.
  </div>
{% endif %}

<div class="recommendations">
<h3> Recommendations</h3>
<ul>
{% for recommendation in vulner_report_data.recommendations %}
  {% if recommendation != '' %}
    <li>{{ recommendation }}</li>
  {% endif %}
{% endfor %}
{% if vulner_report_data.recommendations | select('ne', '') | list | length == 0 %}
  <li>Continue regular vulnerability scanning and security best practices</li>
  <li>Maintain current system update schedule</li>
  <li>Review security configurations periodically</li>
{% endif %}
</ul>
</div>

<div class="timestamp">
<p>Report generated by <strong>Ansible check-vulner role v{{ vulner_role_version }}</strong></p>
<p>Scan completed: {{ vulner_report_data.scan_info.scan_timestamp }}</p>
<p>Next recommended scan: {{ (vulner_report_data.scan_info.scan_timestamp | to_datetime('%Y-%m-%dT%H:%M:%SZ') + timedelta(days=vulner_scan_frequency_days)).strftime('%Y-%m-%d') }}</p>
</div>
</div>
</body>
</html>
